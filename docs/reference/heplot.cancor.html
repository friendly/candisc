<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These functions plot ellipses (or ellipsoids in 3D)
in canonical space
representing the hypothesis and error sums-of-squares-and-products matrices for 
terms in a multivariate linear model representing the result of a
canonical correlation analysis.
They provide a low-rank 2D (or 3D) view of the effects 
in the space of maximum canonical correlations, together with variable
vectors representing the correlations of Y variables with the canonical
dimensions.
For consistency with heplot.candisc, the plots show
effects in the space of the canonical Y variables selected by which."><title>Canonical Correlation HE plots — heplot.cancor • candisc</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Canonical Correlation HE plots — heplot.cancor"><meta property="og:description" content="These functions plot ellipses (or ellipsoids in 3D)
in canonical space
representing the hypothesis and error sums-of-squares-and-products matrices for 
terms in a multivariate linear model representing the result of a
canonical correlation analysis.
They provide a low-rank 2D (or 3D) view of the effects 
in the space of maximum canonical correlations, together with variable
vectors representing the correlations of Y variables with the canonical
dimensions.
For consistency with heplot.candisc, the plots show
effects in the space of the canonical Y variables selected by which."><meta property="og:image" content="https://friendly.github.io/candisc/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">candisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/diabetes.html">Diabetes data: heplots and candisc examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/candisc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Canonical Correlation HE plots</h1>
      
      <div class="d-none name"><code>heplot.cancor.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions plot ellipses (or ellipsoids in 3D)
in canonical space
representing the hypothesis and error sums-of-squares-and-products matrices for 
terms in a multivariate linear model representing the result of a
canonical correlation analysis.
They provide a low-rank 2D (or 3D) view of the effects 
in the space of maximum canonical correlations, together with variable
vectors representing the correlations of Y variables with the canonical
dimensions.</p>
<p>For consistency with <code><a href="heplot.candisc.html">heplot.candisc</a></code>, the plots show
effects in the space of the canonical Y variables selected by <code>which</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for cancor</span></span>
<span><span class="fu">heplot</span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">scale</span>, asp<span class="op">=</span><span class="fl">1</span>,</span>
<span>    var.vectors <span class="op">=</span> <span class="st">"Y"</span>, var.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>, var.lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lwd"</span><span class="op">)</span>, </span>
<span>    var.cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>, var.xpd <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    prefix <span class="op">=</span> <span class="st">"Ycan"</span>, suffix <span class="op">=</span> <span class="cn">TRUE</span>, terms <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for cancor</span></span>
<span><span class="fu">heplot3d</span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">scale</span>, asp<span class="op">=</span><span class="st">"iso"</span>,</span>
<span>    var.vectors <span class="op">=</span> <span class="st">"Y"</span>, var.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>, var.lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lwd"</span><span class="op">)</span>, </span>
<span>    var.cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>, var.xpd <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>    prefix <span class="op">=</span> <span class="st">"Ycan"</span>, suffix <span class="op">=</span> <span class="cn">FALSE</span>, terms <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mod</dt>
<dd><p>A <code>cancor</code> object</p></dd>

  <dt>which</dt>
<dd><p>A numeric vector containing the indices of the Y canonical
  dimensions to plot.</p></dd>

  <dt>scale</dt>
<dd><p>Scale factor for the variable vectors in canonical space.  If
  not specified, the function calculates one to make the variable vectors 
  approximately fill the plot window.</p></dd>

  <dt>asp</dt>
<dd><p>aspect ratio setting. Use <code>asp=1</code> in 2D plots and <code>asp="iso"</code> in 3D plots
   to ensure equal units on the axes. Use <code>asp=NA</code> in 2D plots and <code>asp=NULL</code> in 3D plots
   to allow separate scaling for the axes. See Details below.</p></dd>


  <dt>var.vectors</dt>
<dd><p>Which variable vectors to plot?  A character vector containing one or more
  of <code>"X"</code> and <code>"Y"</code>.</p></dd>


  <dt>var.col</dt>
<dd><p>Color(s) for variable vectors and labels, a vector of length 1 or 2.
  The first color is used for Y vectors and the second for X vectors, if these are plotted.</p></dd>

  <dt>var.lwd</dt>
<dd><p>Line width for variable vectors</p></dd>

  <dt>var.cex</dt>
<dd><p>Text size for variable vector labels</p></dd>

  <dt>var.xpd</dt>
<dd><p>logical. Allow variable labels outside the plot box? Does not apply to 3D plots.</p></dd>

  <dt>prefix</dt>
<dd><p>Prefix for labels of the Y canonical dimensions.</p></dd>

  <dt>suffix</dt>
<dd><p>Suffix for labels of canonical dimensions. If <code>suffix=TRUE</code>
  the percent of hypothesis (H) variance accounted for by each canonical dimension is added to the axis label.</p></dd>


  <dt>terms</dt>
<dd><p>Terms for the X variables to be plotted in canonical space.
The default, <code>terms=TRUE</code> or <code>terms="X"</code>
plots H ellipses for all of the X variables.
<code>terms="Xcan"</code> plots H ellipses for all of the X canonical variables,
<code>Xcan1</code>, <code>Xcan2</code>, ....</p></dd>

  <dt>...</dt>
<dd><p>Other arguments passed to <code>link[heplots]{heplot}</code>.
In particular, you can pass linear hypotheses among the term variables via <code>hypotheses</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The interpretation of variable vectors in these plots is different from that of the
<code>terms</code> plotted as H "ellipses," which appear as degenerate lines in the plot (because they
correspond to 1 df tests of rank(H)=1).</p>
<p>In canonical space, the interpretation of the H ellipses for the <code>terms</code> is the same
as in ordinary HE plots:  a term is significant <em>iff</em> its H ellipse projects outside
the (orthogonalized) E ellipsoid somewhere in the space of the Y canonical dimensions.
The orientation of each H ellipse with respect to the Y canonical dimensions indicates
which dimensions that X variate contributes to.</p>
<p>On the other hand, the variable vectors shown in these plots are intended only to show
the correlations of Y variables with the canonical dimensions.  Only their relative
lengths and angles with respect to the Y canonical dimensions have meaning.
Relative lengths correspond to proportions of variance accounted for in the 
Y canonical dimensions plotted;
angles between the variable vectors and the canonical axes correspond to the
structure correlations. 
The absolute lengths of these vectors are typically manipulated by the 
<code>scale</code> argument to provide better visual resolution and labeling for the variables.</p>
<p>Setting the aspect ratio of these plots is important for the proper interpretation of
angles between the variable vectors and the coordinate axes.  
However, this then makes it impossible to change the aspect ratio of the plot
by re-sizing manually.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns invisibly an object of class <code>"heplot"</code>, with
  coordinates for the various hypothesis ellipses and the error ellipse, and
  the limits of the horizontal and vertical axes.
<!-- %%  If it is a LIST, use --></p>


<p><!-- %%  \item{comp1 }{Description of 'comp1'} --></p>


<p><!-- %%  \item{comp2 }{Description of 'comp2'} --></p>


<p><!-- %% ... --></p>


    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gittins, R. (1985). <em>Canonical Analysis: A Review with Applications in Ecology</em>,
Berlin: Springer.</p>
<p>Mardia, K. V., Kent, J. T. and Bibby, J. M. (1979).
<em>Multivariate Analysis</em>. London: Academic Press.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cancor.html">cancor</a></code> for details on canonical correlation as implemented here;
<code><a href="plot.cancor.html">plot.cancor</a></code> for scatterplots of canonical variable scores.</p>
<p><code><a href="heplot.candisc.html">heplot.candisc</a></code>, <code><a href="https://friendly.github.io/heplots/reference/heplot.html" class="external-link">heplot</a></code>,
<code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rohwer</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Rohwer</span><span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Rohwer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="cancor.html">cancor</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, set.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PA"</span>, <span class="st">"Ability"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># basic plot</span></span></span>
<span class="r-in"><span><span class="fu">heplot</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heplot.cancor-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vector scale factor set to  1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># note relationship of joint hypothesis to individual ones</span></span></span>
<span class="r-in"><span><span class="fu">heplot</span><span class="op">(</span><span class="va">cc</span>, scale<span class="op">=</span><span class="fl">1.25</span>, hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"na+ns"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"na"</span>, <span class="st">"ns"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heplot.cancor-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># more options</span></span></span>
<span class="r-in"><span><span class="fu">heplot</span><span class="op">(</span><span class="va">cc</span>, hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"All X"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>, fill.alpha<span class="op">=</span><span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>  var.cex<span class="op">=</span><span class="fl">1.5</span>, var.col<span class="op">=</span><span class="st">"red"</span>, var.lwd<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>  prefix<span class="op">=</span><span class="st">"Y canonical dimension"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="heplot.cancor-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vector scale factor set to  2 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3D version</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">heplot3d</span><span class="op">(</span><span class="va">cc</span>, var.lwd<span class="op">=</span><span class="fl">3</span>, var.col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Friendly, John Fox.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer></div>

  

  

  </body></html>

