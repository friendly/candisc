<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Canonical Correlation HE plots — heplot.cancor • candisc</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Canonical Correlation HE plots — heplot.cancor"><meta name="description" content="Hypothesis - Error (HE) plots for canonical correlation analysis provide a new graphical method
for understanding the relations between two sets of variables, \(\mathbf{X}\) and \(\mathbf{Y}\).
They are similar to HE plots for multivariate multiple regression (MMRA) problems,
except that ...
These functions plot ellipses (or ellipsoids in 3D) in canonical space
representing the hypothesis and error sums-of-squares-and-products matrices
for terms in a multivariate linear model representing the result of a
canonical correlation analysis. They provide a low-rank 2D (or 3D) view of
the effects in the space of maximum canonical correlations, together with
variable vectors representing the correlations of Y variables with the
canonical dimensions.
For consistency with heplot.candisc(), the plots show effects in
the space of the canonical Y variables selected by which."><meta property="og:description" content="Hypothesis - Error (HE) plots for canonical correlation analysis provide a new graphical method
for understanding the relations between two sets of variables, \(\mathbf{X}\) and \(\mathbf{Y}\).
They are similar to HE plots for multivariate multiple regression (MMRA) problems,
except that ...
These functions plot ellipses (or ellipsoids in 3D) in canonical space
representing the hypothesis and error sums-of-squares-and-products matrices
for terms in a multivariate linear model representing the result of a
canonical correlation analysis. They provide a low-rank 2D (or 3D) view of
the effects in the space of maximum canonical correlations, together with
variable vectors representing the correlations of Y variables with the
canonical dimensions.
For consistency with heplot.candisc(), the plots show effects in
the space of the canonical Y variables selected by which."><meta property="og:image" content="https://friendly.github.io/candisc/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">candisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/diabetes.html">Diabetes data: heplots and candisc examples</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/candisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Canonical Correlation HE plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/candisc/blob/HEAD/R/heplot.cancor.R" class="external-link"><code>R/heplot.cancor.R</code></a></small>
      <div class="d-none name"><code>heplot.cancor.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Hypothesis - Error (HE) plots for canonical correlation analysis provide a new graphical method
for understanding the relations between two sets of variables, \(\mathbf{X}\) and \(\mathbf{Y}\).
They are similar to HE plots for multivariate multiple regression (MMRA) problems,
except that ...</p>
<p>These functions plot ellipses (or ellipsoids in 3D) in canonical space
representing the hypothesis and error sums-of-squares-and-products matrices
for terms in a multivariate linear model representing the result of a
canonical correlation analysis. They provide a low-rank 2D (or 3D) view of
the effects in the space of maximum canonical correlations, together with
variable vectors representing the correlations of Y variables with the
canonical dimensions.</p>
<p>For consistency with <code><a href="heplot.candisc.html">heplot.candisc()</a></code>, the plots show effects in
the space of the canonical Y variables selected by <code>which</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'cancor'</span></span>
<span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html" class="external-link">heplot</a></span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>  <span class="va">scale</span>,</span>
<span>  asp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  var.vectors <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  var.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>  var.lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lwd"</span><span class="op">)</span>,</span>
<span>  var.cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>,</span>
<span>  var.xpd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"Ycan"</span>,</span>
<span>  suffix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mod">mod<a class="anchor" aria-label="anchor" href="#arg-mod"></a></dt>
<dd><p>A <code>"cancor"</code> object, as computed by <code><a href="cancor.html">cancor()</a></code></p></dd>


<dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>A numeric vector containing the indices of the Y canonical
dimensions to plot.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Scale factor for the variable vectors in canonical space.  If
not specified, the function calculates one to make the variable vectors
approximately fill the plot window.</p></dd>


<dt id="arg-asp">asp<a class="anchor" aria-label="anchor" href="#arg-asp"></a></dt>
<dd><p>aspect ratio setting. Use <code>asp=1</code> in 2D plots and
<code>asp="iso"</code> in 3D plots to ensure equal units on the axes. Use
<code>asp=NA</code> in 2D plots and <code>asp=NULL</code> in 3D plots to
allow separate scaling for the axes. See Details below.</p></dd>


<dt id="arg-var-vectors">var.vectors<a class="anchor" aria-label="anchor" href="#arg-var-vectors"></a></dt>
<dd><p>Which variable vectors to plot?  A character vector
containing one or more of <code>"X"</code> and <code>"Y"</code>.</p></dd>


<dt id="arg-var-col">var.col<a class="anchor" aria-label="anchor" href="#arg-var-col"></a></dt>
<dd><p>Color(s) for variable vectors and labels, a vector of length
1 or 2.  The first color is used for Y vectors and the second for X vectors,
if these are plotted.</p></dd>


<dt id="arg-var-lwd">var.lwd<a class="anchor" aria-label="anchor" href="#arg-var-lwd"></a></dt>
<dd><p>Line width for variable vectors</p></dd>


<dt id="arg-var-cex">var.cex<a class="anchor" aria-label="anchor" href="#arg-var-cex"></a></dt>
<dd><p>Text size for variable vector labels</p></dd>


<dt id="arg-var-xpd">var.xpd<a class="anchor" aria-label="anchor" href="#arg-var-xpd"></a></dt>
<dd><p>logical. Allow variable labels outside the plot box? Does not
apply to 3D plots.</p></dd>


<dt id="arg-prefix">prefix<a class="anchor" aria-label="anchor" href="#arg-prefix"></a></dt>
<dd><p>Prefix for labels of the Y canonical dimensions.</p></dd>


<dt id="arg-suffix">suffix<a class="anchor" aria-label="anchor" href="#arg-suffix"></a></dt>
<dd><p>Suffix for labels of canonical dimensions. If
<code>suffix=TRUE</code> the percent of hypothesis (H) variance accounted for by
each canonical dimension is added to the axis label.</p></dd>


<dt id="arg-terms">terms<a class="anchor" aria-label="anchor" href="#arg-terms"></a></dt>
<dd><p>Terms for the X variables to be plotted in canonical space. The
default, <code>terms=TRUE</code> or <code>terms="X"</code> plots H ellipses for all of
the X variables. <code>terms="Xcan"</code> plots H ellipses for all of the X
canonical variables, <code>Xcan1</code>, <code>Xcan2</code>, ....</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to <code>link[heplots]{heplot}</code>. In
particular, you can pass linear hypotheses among the term variables via
<code>hypotheses</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns invisibly an object of class <code>"heplot"</code>, with
coordinates for the various hypothesis ellipses and the error ellipse, and
the limits of the horizontal and vertical axes.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The interpretation of variable vectors in these plots is different from that
of the <code>terms</code> plotted as H "ellipses," which appear as degenerate
lines in the plot (because they correspond to 1 df tests of rank(H)=1).</p>
<p>In canonical space, the interpretation of the H ellipses for the
<code>terms</code> is the same as in ordinary HE plots: a term is significant
<em>iff</em> its H ellipse projects outside the (orthogonalized) E ellipsoid
somewhere in the space of the Y canonical dimensions. The orientation of
each H ellipse with respect to the Y canonical dimensions indicates which
dimensions that X variate contributes to.</p>
<p>On the other hand, the variable vectors shown in these plots are intended
only to show the correlations of Y variables with the canonical dimensions.
Only their relative lengths and angles with respect to the Y canonical
dimensions have meaning. Relative lengths correspond to proportions of
variance accounted for in the Y canonical dimensions plotted; angles between
the variable vectors and the canonical axes correspond to the structure
correlations.  The absolute lengths of these vectors are typically
manipulated by the <code>scale</code> argument to provide better visual resolution
and labeling for the variables.</p>
<p>Setting the aspect ratio of these plots is important for the proper
interpretation of angles between the variable vectors and the coordinate
axes.  However, this then makes it impossible to change the aspect ratio of
the plot by re-sizing manually. You can override this using <code>asp=NA</code> in 2D plots</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gittins, R. (1985). <em>Canonical Analysis: A Review with
Applications in Ecology</em>, Berlin: Springer.</p>
<p>Mardia, K. V., Kent, J. T. and Bibby, J. M. (1979). <em>Multivariate
Analysis</em>. London: Academic Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>  [<span class="fu">cancor</span>()] <span class="cf">for</span> details on canonical correlation as implemented here;</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  [<span class="fu">plot.cancor</span>()] <span class="cf">for</span> scatterplots of canonical  variable scores.</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  [<span class="fu">heplot.candisc</span>()], [heplots<span class="sc">::</span><span class="fu">heplot</span>()], [car<span class="sc">::</span><span class="fu">linearHypothesis</span>()]</span></code></pre><p></p></div></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rohwer</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Rohwer</span><span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Rohwer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="cancor.html">cancor</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, set.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PA"</span>, <span class="st">"Ability"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># basic plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html" class="external-link">heplot</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heplot.cancor-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vector scale factor set to  1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># note relationship of joint hypothesis to individual ones</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html" class="external-link">heplot</a></span><span class="op">(</span><span class="va">cc</span>, scale<span class="op">=</span><span class="fl">1.25</span>, hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"na+ns"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"na"</span>, <span class="st">"ns"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heplot.cancor-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># more options</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot.html" class="external-link">heplot</a></span><span class="op">(</span><span class="va">cc</span>, hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"All X"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>, fill.alpha<span class="op">=</span><span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>  var.cex<span class="op">=</span><span class="fl">1.5</span>, var.col<span class="op">=</span><span class="st">"red"</span>, var.lwd<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>  prefix<span class="op">=</span><span class="st">"Y canonical dimension"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="heplot.cancor-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vector scale factor set to  2 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3D version</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://friendly.github.io/heplots/reference/heplot3d.html" class="external-link">heplot3d</a></span><span class="op">(</span><span class="va">cc</span>, var.lwd<span class="op">=</span><span class="fl">3</span>, var.col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, John Fox.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

