<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='The function cancor generalizes and regularizes computation for
canonical correlation analysis in a way conducive to visualization using
methods in the heplots package.
The package provides the following display, extractor and plotting methods for "cancor" objects
   print(), summary()
Print and summarise the CCA

   coef()
Extract coefficients for X, Y, or both

   scores()
Extract observation scores on the canonical variables

   redundancy()
Redundancy analysis

   plot()
Plot pairs of canonical scores

   heplot()
HE plot of the Y canonical variables showing effects of the X variables and projections
         of the Y variables in this space.



'><title>Canonical Correlation Analysis — cancor • candisc</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Canonical Correlation Analysis — cancor"><meta property="og:description" content='The function cancor generalizes and regularizes computation for
canonical correlation analysis in a way conducive to visualization using
methods in the heplots package.
The package provides the following display, extractor and plotting methods for "cancor" objects
   print(), summary()
Print and summarise the CCA

   coef()
Extract coefficients for X, Y, or both

   scores()
Extract observation scores on the canonical variables

   redundancy()
Redundancy analysis

   plot()
Plot pairs of canonical scores

   heplot()
HE plot of the Y canonical variables showing effects of the X variables and projections
         of the Y variables in this space.



'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">candisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/diabetes.html">Diabetes data: heplots and candisc examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/candisc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Canonical Correlation Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/candisc/blob/HEAD/R/cancor.R" class="external-link"><code>R/cancor.R</code></a></small>
      <div class="d-none name"><code>cancor.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>cancor</code> generalizes and regularizes computation for
canonical correlation analysis in a way conducive to visualization using
methods in the <code><a href="https://friendly.github.io/heplots/reference/heplots-package.html" class="external-link">heplots</a></code> package.</p>
<p>The package provides the following display, extractor and plotting methods for <code>"cancor"</code> objects</p><dl><dt><code>print(), summary()</code></dt>
<dd><p>Print and summarise the CCA</p></dd>

   <dt><code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code></dt>
<dd><p>Extract coefficients for X, Y, or both</p></dd>

   <dt><code>scores()</code></dt>
<dd><p>Extract observation scores on the canonical variables</p></dd>

   <dt><code><a href="redundancy.html">redundancy()</a></code></dt>
<dd><p>Redundancy analysis</p></dd>

   <dt><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code></dt>
<dd><p>Plot pairs of canonical scores</p></dd>

   <dt><code>heplot()</code></dt>
<dd><p>HE plot of the Y canonical variables showing effects of the X variables and projections
         of the Y variables in this space.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cancor</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">cancor</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">weights</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"gensvd"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">cancor</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  X.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  Y.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  xcenter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ycenter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xscale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  yscale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ndim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">q</span><span class="op">)</span>,</span>
<span>  set.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>  prefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Xcan"</span>, <span class="st">"Ycan"</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">na.rm</span><span class="op">)</span> <span class="st">"complete"</span> <span class="kw">else</span> <span class="st">"pairwise"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"gensvd"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for cancor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for cancor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for cancor</span></span>
<span><span class="fu">scores</span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"both"</span>, <span class="st">"list"</span>, <span class="st">"data.frame"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for cancor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"both"</span>, <span class="st">"list"</span><span class="op">)</span>, standardize <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Varies depending on method. For the <code>cancor.default</code> method,
this should be a matrix or data.frame whose columns contain the X variables</p></dd>


<dt>...</dt>
<dd><p>Other arguments, passed to methods</p></dd>


<dt>formula</dt>
<dd><p>A two-sided formula of the form <code>cbind(y1, y2, y3, ...) ~ x1 + x2 + x3 + ...</code></p></dd>


<dt>data</dt>
<dd><p>The data.frame within which the formula is evaluated</p></dd>


<dt>subset</dt>
<dd><p>an optional vector specifying a subset of observations to be
used in the calculations.</p></dd>


<dt>weights</dt>
<dd><p>Observation weights. If supplied, this must be a vector of
length equal to the number of observations in X and Y, typically within
[0,1].  In that case, the variance-covariance matrices are computed using
<code><a href="https://rdrr.io/r/stats/cov.wt.html" class="external-link">cov.wt</a></code>, and the number of observations is taken as the
number of non-zero weights.</p></dd>


<dt>na.rm</dt>
<dd><p>logical, determining whether observations with missing cases
are excluded in the computation of the variance matrix of (X,Y).  See Notes
for details on missing data.</p></dd>


<dt>method</dt>
<dd><p>the method to be used for calculation; currently only
<code>method = "gensvd"</code> is supported;</p></dd>


<dt>y</dt>
<dd><p>For the <code>cancor.default</code> method, a matrix or data.frame whose
columns contain the Y variables</p></dd>


<dt>X.names, Y.names</dt>
<dd><p>Character vectors of names for the X and Y variables.</p></dd>


<dt>row.names</dt>
<dd><p>Observation names in <code>x</code>, <code>y</code></p></dd>


<dt>xcenter, ycenter</dt>
<dd><p>logical. Center the X, Y variables? [not yet implemented]</p></dd>


<dt>xscale, yscale</dt>
<dd><p>logical. Scale the X, Y variables to unit variance? [not yet implemented]</p></dd>


<dt>ndim</dt>
<dd><p>Number of canonical dimensions to retain in the result, for
scores, coefficients, etc.</p></dd>


<dt>set.names</dt>
<dd><p>A vector of two character strings, giving names for the
collections of the X, Y variables.</p></dd>


<dt>prefix</dt>
<dd><p>A vector of two character strings, giving prefixes used to
name the X and Y canonical variables, respectively.</p></dd>


<dt>use</dt>
<dd><p>argument passed to <code>var</code> determining how missing data are
handled.  Only the default, <code>use="complete"</code> is allowed when
observation weights are supplied.</p></dd>


<dt>digits</dt>
<dd><p>Number of digits passed to <code>print</code> and <code>summary</code> methods</p></dd>


<dt>object</dt>
<dd><p>A <code>cancor</code> object for related methods.</p></dd>


<dt>type</dt>
<dd><p>For the <code>coef</code> method, the type of coefficients returned,
one of <code>"x"</code>, <code>"y"</code>, <code>"both"</code>. For the <code>scores</code> method,
the same list, or <code>"data.frame"</code>, which returns a data.frame containing
the X and Y canonical scores.</p></dd>


<dt>standardize</dt>
<dd><p>For the <code>coef</code> method, whether coefficients should
be standardized by dividing by the standard deviations of the X and Y
variables.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>cancorr</code>, a list with the following
       components:</p>
<dl><dt>cancor</dt>
<dd><p>Canonical correlations, i.e., the correlations
       between each canonical variate for the Y variables with the corresponding
       canonical variate for the X variables.</p></dd>
 
   <dt>names</dt>
<dd><p>Names for various
       items, a list of 4 components: <code>X</code>, <code>Y</code>, <code>row.names</code>, <code>set.names</code></p></dd>
 
   <dt>ndim</dt>
<dd><p>Number of canonical dimensions extracted, <code>&lt;= min(p,q)</code></p></dd>
 
   <dt>dim</dt>
<dd><p>Problem dimensions, a list of 3 components:
         <code>p</code> (number of X variables), <code>q</code> (number of Y variables), <code>n</code> (sample size)</p></dd>
 
    <dt>coef</dt>
<dd><p>Canonical coefficients, a list of 2 components:
<code>X</code>, <code>Y</code></p></dd>
 </dl><p><!-- %  --></p>
<dl><dt>scores</dt>
<dd><p>Canonical variate scores, a list of 2 components: <code>X</code>, <code>Y</code></p></dd>
 
    <dt>scores</dt>
<dd><p>Canonical variate scores, a list of 2 components:</p><dl><dt>list("X")</dt>
<dd><p>Canonical variate scores for the X variables</p></dd>
 
        <dt>list("Y")</dt>
<dd><p>Canonical variate scores for the Y variables</p></dd>
 
</dl><p></p></dd>
 
    <dt>X</dt>
<dd><p>The matrix X</p></dd>
 <dt>Y</dt>
<dd><p>The matrix Y</p></dd>

<dt>weights</dt>
<dd><p>Observation weights, if supplied, else <code>NULL</code></p></dd>
 </dl><p><!-- % --></p>
<dl><dt>structure</dt>
<dd><p>Structure correlations, a list of 4 components:
    <code>X.xscores</code>, <code>Y.xscores</code>, <code>X.yscores</code>, <code>Y.yscores</code></p></dd>


<dt>structure</dt>
<dd><p>Structure correlations ("loadings"), a list of 4
components:</p><dl><dt>X.xscores</dt>
<dd><p>Structure correlations of the X variables with the Xcan canonical scores</p></dd>
 
     <dt>Y.xscores</dt>
<dd><p>Structure correlations of the Y variables with the Xcan canonical scores</p></dd>

     <dt>X.yscores</dt>
<dd><p>Structure correlations of the X variables with the Ycan canonical scores</p></dd>
 
     <dt>Y.yscores</dt>
<dd><p>Structure correlations of the Y variables with the Ycan canonical scores</p></dd>
 
 
</dl><p>The formula method also returns components <code>call</code> and <code>terms</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Canonical correlation analysis (CCA), as traditionally presented is used to
identify and measure the associations between two sets of quantitative
variables, X and Y.  It is often used in the same situations for which a
multivariate multiple regression analysis (MMRA) would be used.  However,
CCA is is “symmetric” in that the sets X and Y have equivalent
status, and the goal is to find orthogonal linear combinations of each
having maximal (canonical) correlations. On the other hand, MMRA is
“asymmetric”, in that the Y set is considered as responses,
<em>each one</em> to be explained by <em>separate</em> linear combinations of
the Xs.</p>
<p>Let \(\mathbf{Y}_{n \times p}\) and \(\mathbf{X}_{n \times q}\) be two sets of variables over which 
CCA is computed. We find canonical coefficients \(\mathbf{A}_{p \times k}\) and 
\(\mathbf{B}_{q \times k}, k=\min(p,q)\) such that the canonical variables 
\(\mathbf{U}_{n \times k}\) and \(\mathbf{V}_{n \times k}\) have maximal, diagonal correlation structure.
That is, the coefficients \(\mathbf{A}\) and \(\mathbf{B}\) are chosen such that the correlations between
each pair \(r_i = \text{cor}(\mathbf{u}_i, \mathbf{v}_i), i=1, 2, \dots , k\) 
are maximized and all other pairs are uncorrelated,
\(r_{ij} = \text{cor}(\mathbf{u}_i, \mathbf{v}_j) = 0,  i \ne j\)</p>
<p>This implementation of <code>cancor</code> provides the basic computations for
CCA, together with some extractor functions and methods 
(<code>scores()</code>, <code></code>)
for working with the
results in a convenient fashion.</p>
<p>However, for visualization using HE plots, it is most natural to consider
plots representing the relations among the canonical variables for the Y
variables in terms of a multivariate linear model predicting the Y canonical
scores, using either the X variables or the X canonical scores as
predictors.  Such plots, using <code><a href="heplot.cancor.html">heplot.cancor</a></code> provide a
low-rank (1D, 2D, 3D) visualization of the relations between the two sets,
and so are useful in cases when there are more than 2 or 3 variables in each
of X and Y.</p>
<p>The connection between CCA and HE plots for MMRA models can be developed as
follows. CCA can also be viewed as a principal component transformation of
the predicted values of one set of variables from a regression on the other
set of variables, in the metric of the error covariance matrix.</p>
<p>For example, regress the Y variables on the X variables, giving predicted
values \(\hat{Y} = X (X'X)^{-1} X' Y\) and residuals \(R = Y -
\hat{Y}\). The error covariance matrix is \(E = R'R/(n-1)\).  Choose a
transformation Q that orthogonalizes the error covariance matrix to an
identity, that is, \((RQ)'(RQ) = Q' R' R Q = (n-1) I\), and apply the same
transformation to the predicted values to yield, say, \(Z = \hat{Y} Q\).
Then, a principal component analysis on the covariance matrix of Z gives
eigenvalues of \(E^{-1} H\), and so is equivalent to the MMRA analysis of
<code>lm(Y ~ X)</code> statistically, but visualized here in canonical space.</p>
    </div>
    <div class="section level2">
    <h2 id="methods-by-class-">Methods (by class)<a class="anchor" aria-label="anchor" href="#methods-by-class-"></a></h2>
    
<ul><li><p><code>cancor(formula)</code>: <code>"formula"</code> method.</p></li>
<li><p><code>cancor(default)</code>: <code>"default"</code> method.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="methods-by-generic-">Methods (by generic)<a class="anchor" aria-label="anchor" href="#methods-by-generic-"></a></h2>
    
<ul><li><p><code>print(cancor)</code>: <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method for <code>"cancor"</code> objects.</p></li>
<li><p><code>summary(cancor)</code>: <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method for <code>"cancor"</code> objects.</p></li>
<li><p><code>scores(cancor)</code>: <code>scores()</code> method for <code>"cancor"</code> objects.</p></li>
<li><p><code>coef(cancor)</code>: <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> method for <code>"cancor"</code> objects.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Not all features of CCA are presently implemented: standardized vs.
raw scores, more flexible handling of missing data, other plot methods, ...</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gittins, R. (1985). <em>Canonical Analysis: A Review with
Applications in Ecology</em>, Berlin: Springer.</p>
<p>Mardia, K. V., Kent, J. T. and Bibby, J. M. (1979). <em>Multivariate
Analysis</em>. London: Academic Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other implementations of CCA: <code><a href="https://rdrr.io/r/stats/cancor.html" class="external-link">cancor</a></code> (very
basic), <code><a href="https://rdrr.io/pkg/yacca/man/cca.html" class="external-link">cca</a></code> in the <span class="pkg">yacca</span> (fairly complete, but
very messy return structure), <code><a href="https://rdrr.io/pkg/CCA/man/cc.html" class="external-link">cc</a></code> in <span class="pkg">CCA</span> (fairly
complete, very messy return structure, no longer maintained).</p>
<p><code><a href="redundancy.html">redundancy</a></code>, for redundancy analysis;
<code><a href="plot.cancor.html">plot.cancor</a></code>, for enhanced scatterplots of the canonical
variates.</p>
<p><code><a href="heplot.cancor.html">heplot.cancor</a></code> for CCA HE plots and
<code><a href="https://friendly.github.io/heplots/reference/heplots-package.html" class="external-link">heplots</a></code> for generic heplot methods.</p>
<p><code><a href="candisc.html">candisc</a></code> for related methods focused on multivariate linear
models with one or more factors among the X variables.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rohwer</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Rohwer</span><span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>  <span class="co"># the PA tests</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Rohwer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>   <span class="co"># the aptitude/ability variables</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># visualize the correlation matrix using corrplot()</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot" class="external-link">corrplot</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">M</span>, method<span class="op">=</span><span class="st">"ellipse"</span>, order<span class="op">=</span><span class="st">"hclust"</span>, addrect<span class="op">=</span><span class="fl">2</span>, addCoef.col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: corrplot</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> corrplot 0.92 loaded</span>
<span class="r-plt img"><img src="cancor-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu">cancor</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, set.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PA"</span>, <span class="st">"Ability"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Canonical correlation analysis of:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 5   PA  variables:  n, s, ns, na, ss </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   with	 3   Ability  variables:  SAT, PPVT, Raven </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CanR  CanRSQ   Eigen percent    cum                          scree</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6703 0.44934 0.81599   77.30  77.30 ******************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.3837 0.14719 0.17260   16.35  93.65 ******                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.2506 0.06282 0.06704    6.35 100.00 **                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of H0: The canonical correlations in the </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> current row and all that follow are zero</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      CanR LR test stat approx F numDF denDF   Pr(&gt; F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.67033      0.44011   3.8961    15 168.8 5.535e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.38366      0.79923   1.8379     8 124.0   0.07608 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.25065      0.93718   1.4078     3  63.0   0.24881    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Canonical correlation analysis of:</span></span></span>
<span class="r-in"><span><span class="co">##       5   PA  variables:  n, s, ns, na, ss </span></span></span>
<span class="r-in"><span><span class="co">##   with        3   Ability  variables:  SAT, PPVT, Raven </span></span></span>
<span class="r-in"><span><span class="co">## </span></span></span>
<span class="r-in"><span><span class="co">##     CanR  CanRSQ   Eigen percent    cum                          scree</span></span></span>
<span class="r-in"><span><span class="co">## 1 0.6703 0.44934 0.81599   77.30  77.30 ******************************</span></span></span>
<span class="r-in"><span><span class="co">## 2 0.3837 0.14719 0.17260   16.35  93.65 ******                        </span></span></span>
<span class="r-in"><span><span class="co">## 3 0.2506 0.06282 0.06704    6.35 100.00 **                            </span></span></span>
<span class="r-in"><span><span class="co">## </span></span></span>
<span class="r-in"><span><span class="co">## Test of H0: The canonical correlations in the </span></span></span>
<span class="r-in"><span><span class="co">## current row and all that follow are zero</span></span></span>
<span class="r-in"><span><span class="co">## </span></span></span>
<span class="r-in"><span><span class="co">##      CanR  WilksL      F df1   df2  p.value</span></span></span>
<span class="r-in"><span><span class="co">## 1 0.67033 0.44011 3.8961  15 168.8 0.000006</span></span></span>
<span class="r-in"><span><span class="co">## 2 0.38366 0.79923 1.8379   8 124.0 0.076076</span></span></span>
<span class="r-in"><span><span class="co">## 3 0.25065 0.93718 1.4078   3  63.0 0.248814</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># formula method</span></span></span>
<span class="r-in"><span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu">cancor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SAT</span>, <span class="va">PPVT</span>, <span class="va">Raven</span><span class="op">)</span> <span class="op">~</span>  <span class="va">n</span> <span class="op">+</span> <span class="va">s</span> <span class="op">+</span> <span class="va">ns</span> <span class="op">+</span> <span class="va">na</span> <span class="op">+</span> <span class="va">ss</span>, data<span class="op">=</span><span class="va">Rohwer</span>, </span></span>
<span class="r-in"><span>    set.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PA"</span>, <span class="st">"Ability"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-list contrasts argument ignored</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using observation weights</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Rohwer</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">ccw</span> <span class="op">&lt;-</span> <span class="fu">cancor</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, set.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PA"</span>, <span class="st">"Ability"</span><span class="op">)</span>, weights<span class="op">=</span><span class="va">wts</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Canonical correlation analysis of:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 5   PA  variables:  n, s, ns, na, ss </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   with	 3   Ability  variables:  SAT, PPVT, Raven </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CanR  CanRSQ   Eigen percent    cum                          scree</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6738 0.45396 0.83136  78.894  78.89 ******************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.3827 0.14645 0.17157  16.282  95.18 ******                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.2199 0.04837 0.05083   4.824 100.00 **                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of H0: The canonical correlations in the </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> current row and all that follow are zero</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      CanR LR test stat approx F numDF  denDF   Pr(&gt; F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.67376      0.44353   3.4755    15 152.23 4.139e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.38268      0.81227   1.5338     8 112.00    0.1534    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.21993      0.95163   0.9658     3  57.00    0.4152    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show correlations of the canonical scores </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/zapsmall.html" class="external-link">zapsmall</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu">scores</span><span class="op">(</span><span class="va">cc</span>, type<span class="op">=</span><span class="st">"x"</span><span class="op">)</span>, <span class="fu">scores</span><span class="op">(</span><span class="va">cc</span>, type<span class="op">=</span><span class="st">"y"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Ycan1     Ycan2     Ycan3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Xcan1 0.6703254 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Xcan2 0.0000000 0.3836569 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Xcan3 0.0000000 0.0000000 0.2506487</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># standardized coefficients</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cc</span>, type<span class="op">=</span><span class="st">"both"</span>, standardize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Xcan1       Xcan2      Xcan3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n  -0.2918658  0.17681207 -0.5064680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s   0.2376371 -0.49037479 -1.0227353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ns  0.6217178 -1.21506423  0.5090243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> na -0.8636882  0.58576035  0.3154802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ss -0.5380809  0.04973148  0.2171691</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Ycan1      Ycan2      Ycan3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAT   -0.4279751  0.7620281 -0.7643153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PPVT  -0.8117586 -0.2691718  0.8335792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Raven  0.1940206 -0.9301330 -0.6401159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cc</span>, smooth<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cancor-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##################</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">schooldata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">##################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#fit the MMreg model</span></span></span>
<span class="r-in"><span><span class="va">school.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">reading</span>, <span class="va">mathematics</span>, <span class="va">selfesteem</span><span class="op">)</span> <span class="op">~</span> </span></span>
<span class="r-in"><span><span class="va">education</span> <span class="op">+</span> <span class="va">occupation</span> <span class="op">+</span> <span class="va">visit</span> <span class="op">+</span> <span class="va">counseling</span> <span class="op">+</span> <span class="va">teacher</span>, data<span class="op">=</span><span class="va">schooldata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">school.mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type II MANOVA Tests: Pillai test statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df test stat approx F num Df den Df    Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> education   1   0.37564  12.4337      3     62 1.820e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> occupation  1   0.56658  27.0159      3     62 2.687e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> visit       1   0.26032   7.2734      3     62 0.0002948 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> counseling  1   0.06465   1.4286      3     62 0.2429676    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> teacher     1   0.04906   1.0661      3     62 0.3700291    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">school.mod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cancor-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># canonical correlation analysis</span></span></span>
<span class="r-in"><span><span class="va">school.cc</span> <span class="op">&lt;-</span> <span class="fu">cancor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">reading</span>, <span class="va">mathematics</span>, <span class="va">selfesteem</span><span class="op">)</span> <span class="op">~</span> </span></span>
<span class="r-in"><span><span class="va">education</span> <span class="op">+</span> <span class="va">occupation</span> <span class="op">+</span> <span class="va">visit</span> <span class="op">+</span> <span class="va">counseling</span> <span class="op">+</span> <span class="va">teacher</span>, data<span class="op">=</span><span class="va">schooldata</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-list contrasts argument ignored</span>
<span class="r-in"><span><span class="va">school.cc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Canonical correlation analysis of:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 5   X  variables:  education, occupation, visit, counseling, teacher </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   with	 3   Y  variables:  reading, mathematics, selfesteem </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CanR CanRSQ    Eigen  percent    cum                          scree</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.9967 0.9934 151.0502 99.09963  99.10 ******************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.7456 0.5559   1.2516  0.82112  99.92                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.3283 0.1078   0.1208  0.07925 100.00                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of H0: The canonical correlations in the </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> current row and all that follow are zero</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      CanR LR test stat approx F numDF  denDF   Pr(&gt; F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.99671      0.00261   87.272    15 171.56 &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.74556      0.39627    9.270     8 126.00 5.476e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.32829      0.89222    2.577     3  64.00   0.06141 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span><span class="fu">heplot</span><span class="op">(</span><span class="va">school.cc</span>, xpd<span class="op">=</span><span class="cn">TRUE</span>, scale<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cancor-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Friendly, John Fox.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer></div>

  

  

  </body></html>

