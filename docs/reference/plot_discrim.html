<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a Discriminant Analysis Decision Plot using ggplot. — plot_discrim • candisc</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a Discriminant Analysis Decision Plot using ggplot. — plot_discrim"><meta name="description" content="
Discriminant analysis can be more easily understood from plots of the data variables showing how observations are classified.
plot_discrim() uses the ideas behind effect plots (Fox, 1987): Visualize predicted classes of the observations for two focal variables over a
grid of their values, with other variables in a model held fixed. This differs from the usual effect plots in that the predicted
values to be visualized are discrete categories rather than quantitative.
In the case of discriminant analysis, the predicted values are class membership,
so this can be visualized by mapping the categorical predicted class to discrete colors used as the background for the plot, or
plotting the contours of predicted class membership as lines (for [MASS::lda()]) or auadratic curves (for [MASS::qda()]) in the plot.
The predicted class of any observation in the space of the variables displayed can also be rendered as colored tiles or points
in the background of the plot."><meta property="og:description" content="
Discriminant analysis can be more easily understood from plots of the data variables showing how observations are classified.
plot_discrim() uses the ideas behind effect plots (Fox, 1987): Visualize predicted classes of the observations for two focal variables over a
grid of their values, with other variables in a model held fixed. This differs from the usual effect plots in that the predicted
values to be visualized are discrete categories rather than quantitative.
In the case of discriminant analysis, the predicted values are class membership,
so this can be visualized by mapping the categorical predicted class to discrete colors used as the background for the plot, or
plotting the contours of predicted class membership as lines (for [MASS::lda()]) or auadratic curves (for [MASS::qda()]) in the plot.
The predicted class of any observation in the space of the variables displayed can also be rendered as colored tiles or points
in the background of the plot."><meta property="og:image" content="https://friendly.github.io/candisc/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">candisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/diabetes.html">Diabetes data: heplots and candisc examples</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/candisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a Discriminant Analysis Decision Plot using ggplot.</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/candisc/blob/HEAD/R/plot_discrim.R" class="external-link"><code>R/plot_discrim.R</code></a></small>
      <div class="d-none name"><code>plot_discrim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>Discriminant analysis can be more easily understood from plots of the data variables showing how observations are classified.
<code>plot_discrim()</code> uses the ideas behind <strong>effect plots</strong> (Fox, 1987): Visualize predicted classes of the observations for two focal variables over a
grid of their values, with other variables in a model held fixed. This differs from the usual effect plots in that the predicted
values to be visualized are discrete categories rather than quantitative.</p>
<p>In the case of discriminant analysis, the predicted values are class membership,
so this can be visualized by mapping the categorical predicted class to discrete colors used as the background for the plot, or
plotting the <strong>contours</strong> of predicted class membership as lines (for <code>[MASS::lda()]</code>) or auadratic curves (for <code>[MASS::qda()]</code>) in the plot.
The predicted class of any observation in the space of the variables displayed can also be rendered as colored <strong>tiles</strong> or <strong>points</strong>
in the background of the plot.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_discrim</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">vars</span>,</span>
<span>  data <span class="op">=</span> <span class="fu">insight</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/insight/reference/get_data.html" class="external-link">get_data</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  point.size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  showgrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tile"</span>, <span class="st">"point"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour.color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  tile.alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  ellipse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">modes.means</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a discriminant analysis model object from <code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">MASS::lda()</a></code> or <code><a href="https://rdrr.io/pkg/MASS/man/qda.html" class="external-link">MASS::qda()</a></code></p></dd>


<dt id="arg-vars">vars<a class="anchor" aria-label="anchor" href="#arg-vars"></a></dt>
<dd><p>either a character vector of length 2 of the names of the <code>x</code> and <code>y</code> variables, or a formula of form <code>y ~ x</code>
specifying the axes in the plot.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data to use for visualization. Should contain all the data needed to use the <code>model</code> for prediction. The default is to use
the data used to fit the <code>model</code>.</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p>number of points in x, y variables to use for visualizing the predicted class boundaries and regions.</p></dd>


<dt id="arg-point-size">point.size<a class="anchor" aria-label="anchor" href="#arg-point-size"></a></dt>
<dd><p>size of the plot symbols use to show the data observations</p></dd>


<dt id="arg-showgrid">showgrid<a class="anchor" aria-label="anchor" href="#arg-showgrid"></a></dt>
<dd><p>a character string; how to display predicted class regions: <code>"tile"</code> for <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_tile()</a></code>, <code>"point"</code>
for <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">ggplot2::geom_point()</a></code>, or <code>"none"</code> for no grid display.</p></dd>


<dt id="arg-contour">contour<a class="anchor" aria-label="anchor" href="#arg-contour"></a></dt>
<dd><p>logical (default: <code>TRUE</code>); should the plot display the boundaries of the classes by contours?</p></dd>


<dt id="arg-contour-color">contour.color<a class="anchor" aria-label="anchor" href="#arg-contour-color"></a></dt>
<dd><p>color of the lines for the contour boundaries (default: <code>"black"</code>)</p></dd>


<dt id="arg-tile-alpha">tile.alpha<a class="anchor" aria-label="anchor" href="#arg-tile-alpha"></a></dt>
<dd><p>transparency value for the background tiles of predicted class.</p></dd>


<dt id="arg-ellipse">ellipse<a class="anchor" aria-label="anchor" href="#arg-ellipse"></a></dt>
<dd><p>logical; if <code>TRUE</code>, 68 percent data ellipses for the groups are added to the plot.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further parameters passed to <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code></p></dd>


<dt id="arg-modes-means">modes.means<a class="anchor" aria-label="anchor" href="#arg-modes-means"></a></dt>
<dd><p>levels to use for evaluating predictions using the variables <strong>not</strong> specified in <code>vars</code>. If not specified,
the function uses the means for quantitative variables, ...</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This is an initial version of <code>plot_discrim()</code>. It is marked "experimental" because the arguments and defaults are still subject to change.</p>
<p><strong>Customizing colors and shapes</strong></p>
<p>Since <code>plot_discrim()</code> returns a <code>"ggplot"</code> object, you can easily customize colors and shapes by adding scale layers after
the function call. You can also add other graphic layers, such as annotations or labels for the groups.</p><ul><li><p>Use <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual()</a></code> <strong>and</strong> <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual()</a></code> to control the colors used when using <code>showgrid = "tile"</code>, because that maps
both <strong>both</strong> <code>color</code> and <code>fill</code> to the group variable.</p></li>
<li><p>Use <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual()</a></code> to control the symbols used for <code>geom_points()</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fox, J. (1987). Effect Displays for Generalized Linear Models. In C. C. Clogg (Ed.), <em>Sociological Methodology</em>, 1987 (pp. 347–361). Jossey-Bass</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/klaR/man/partimat.html" class="external-link">klaR::partimat()</a></code> for pairwise discriminant plots, but with little control of plot details</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Original code by Oliver on SO <a href="https://stackoverflow.com/questions/63782598/quadratic-discriminant-analysis-qda-plot-in-r" class="external-link">https://stackoverflow.com/questions/63782598/quadratic-discriminant-analysis-qda-plot-in-r</a>.</p>
<p>Generalized by Michael Friendly</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">iris.lda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">lda</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># formula call: y ~ x</span></span></span>
<span class="r-in"><span><span class="fu">plot_discrim</span><span class="op">(</span><span class="va">iris.lda</span>, <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Petal.Width</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_discrim-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add data ellipses</span></span></span>
<span class="r-in"><span><span class="fu">plot_discrim</span><span class="op">(</span><span class="va">iris.lda</span>, <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Petal.Width</span>, </span></span>
<span class="r-in"><span>             ellipse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="plot_discrim-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># without contours</span></span></span>
<span class="r-in"><span><span class="co"># data ellipses</span></span></span>
<span class="r-in"><span><span class="fu">plot_discrim</span><span class="op">(</span><span class="va">iris.lda</span>, <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Petal.Width</span>, </span></span>
<span class="r-in"><span>             contour <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="plot_discrim-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specifying `vars` as character names for x, y</span></span></span>
<span class="r-in"><span><span class="fu">plot_discrim</span><span class="op">(</span><span class="va">iris.lda</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Petal.Width"</span>, <span class="st">"Petal.Length"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_discrim-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define custom colors and shapes, modify theme() and legend.position</span></span></span>
<span class="r-in"><span><span class="va">iris.colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris.pch</span> <span class="op">&lt;-</span> <span class="fl">15</span><span class="op">:</span><span class="fl">17</span></span></span>
<span class="r-in"><span><span class="fu">plot_discrim</span><span class="op">(</span><span class="va">iris.lda</span>, <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Petal.Width</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">iris.colors</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">iris.colors</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">iris.pch</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span></span>
<span class="r-in"><span>        legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_discrim-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quadratic discriminant analysis gives quite a different result</span></span></span>
<span class="r-in"><span><span class="va">iris.qda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/qda.html" class="external-link">qda</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_discrim</span><span class="op">(</span><span class="va">iris.qda</span>, <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Petal.Width</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_discrim-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, John Fox.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

